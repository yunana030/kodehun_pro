<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team2 Project Layout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="/tooplate-inner-peace.css" rel="stylesheet">

</head>
<body>
    <div class="geometric-bg"></div>
    <header>
        <nav class="nav-wrap">
            <!-- 로고 -->
            <div class="nav-left">
                <a href="#hero" class="logo" aria-label="Ko-데헌">
                    <img th:src="@{/images/kodehun-badge.svg}" alt="Ko-데헌 로고" height="40">
                    <span class="logo-text">Ko-데헌</span>
                </a>
            </div>

            <!-- 중앙/좌측 링크: 필요 시 유지 -->
            <div class="nav-center">
                <ul class="nav-links">
                    <li><a href="/main" class="nav-link active">Home</a></li>
                    <li><a href="/place/list" class="nav-link">Place</a></li>
                    <li><a href="/free/list" class="nav-link">Free</a></li>
                </ul>
            </div>

            <!-- 오른쪽 영역 -->
            <div class="nav-right">
                <div class="nav-right">
                    <!-- 로그인 버튼: 익명일 때만 -->
                    <!--<a class="btn-login" th:href="@{/login}" sec:authorize="isAnonymous()">로그인</a>-->
                    <a class="btn-login" href="#" sec:authorize="isAnonymous()" data-bs-toggle="modal" data-bs-target="#loginModal">로그인</a>

                    <!-- 아바타 드롭다운: 인증됐을 때만 -->
                    <div class="userbox" sec:authorize="isAuthenticated()">
                        <button id="userMenuBtn" class="avatar-btn" type="button" aria-haspopup="true" aria-expanded="false">
    <!--                        <img class="avatar-img" th:src="@{/images/avatar-default.png}" alt="profile">-->
                            <div class="circle-avatar">
                                <img class="avatar"
                                     th:src="${#authentication.principal.avatarUrl} ?: '/images/icon.png'"
                                     onerror="this.onerror=null;this.src='/images/icon.png';" alt="me"/>
                            </div>
                            <span class="avatar-name" sec:authentication="name">사용자</span>
                            <svg width="14" height="14" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 10l5 5 5-5z"/></svg>
                        </button>
                        <div id="userMenu" class="user-menu" role="menu" aria-labelledby="userMenuBtn">
                            <div class="user-menu-header">
                                <!--<img class="avatar-img" th:src="@{/images/avatar-default.png}" alt="profile">-->
                                <img id="avatarThumb" class="user-menu-avatar"
                                     th:src="${#authentication.principal.avatarUrl} ?: '/images/icon.png'" alt="avatar"/>
                                <!-- onerror="this.onerror=null;this.src='/images/avatar-default.png';" -->
                                <!-- 인증된 경우에만 노출 -->
                                <div sec:authorize="isAuthenticated()">
                                    <strong sec:authentication="principal.displayName">User</strong>
                                    <small  sec:authentication="principal.roleName">ROLE_USER</small>
                                </div>
                                <form id="avatarForm" action="/account/avatar" method="post" enctype="multipart/form-data" style="display:none">
                                    <input id="avatarInput" type="file" name="avatar" accept="image/*">
                                </form>
                            </div>
                            <ul class="user-menu-list">
                                <li><a th:href="@{/mypage}" role="menuitem">내 정보 보기</a></li>
    <!--                            <li><a th:href="@{/checklist}" role="menuitem">Checklist</a></li>-->
                                <li><a th:href="@{/mypage/favoritelist}" role="menuitem">찜하기 목록</a></li>
                                <li><a th:href="@{/mypage/written}" role="menuitem">내 게시물 관리</a></li>
                                <li class="divider"></li>
                                <li>
                                    <form th:action="@{/logout}" method="post">
                                        <button type="submit" class="logout-btn" role="menuitem">로그아웃</button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <!-- 자식 템플릿(main.html)이 이 자리에 내용을 채움 -->
        <div layout:fragment="content"></div>
    </main>

    <!-- 로그인 모달 -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">회원 로그인</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/member/loginProcess}" method="post">
                        <div class="mb-3">
                            <label class="form-label">username</label>
                            <input type="text" name="username" class="form-control" placeholder="username">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" name="password" class="form-control" placeholder="password">
                        </div>
                        <div class="mb-3 d-flex justify-content-between">
                            <button type="submit" class="admin-btn">Login</button>
                            <a th:href="@{/member/join}" class="admin-btn">Join</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="#privacy">Privacy Policy</a>
                <a href="#terms">Terms of Service</a>
                <a href="#support">Support</a>
            </div>
            <div class="copyright">
                <p style="margin-bottom: 0">&copy; 2025 Inner Peace. All rights reserved. Nurturing minds, one breath at a time.
                    Designed by <a rel="nofollow noopener" href="https://www.tooplate.com" target="_blank" style="color: var(--accent); text-decoration: none; transition: color 0.3s ease;">Tooplate</a></p>
            </div>
        </div>
    </footer>
<script src="/tooplate-inner-peace-scripts.js"></script>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="/js/scripts.js"></script>
<th:block layout:fragment="script"></th:block>
<script src="/js/admin.js"></script>


<style>
    header{
        padding: 25px;
    }

    .nav-wrap {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;       /* 부모가 body라면 화면 끝까지 */
        padding: 0 2rem;   /* 필요하면 */
        max-width: 2000px;
    }
    .nav-links {
        display: flex;
        gap: 2.5rem;
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .nav-center {
        flex: 1; /* 좌우 사이 공간 모두 차지 */
        display: flex;
        justify-content: center; /* 링크를 정확히 가운데로 */
    }

    .nav-left,
    .nav-right {
        flex: 0 0 auto; /* 최소 너비만 차지 */
    }

</style>

</body>
</html>